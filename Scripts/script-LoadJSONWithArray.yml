commonfields:
  id: LoadJSONWithArray
  version: -1
name: LoadJSONWithArray
script: |-
  import json
  JSON_CONTEXT_KEY = "JsonObject"
  json_str = demisto.args()['Input']
  obj = json.loads(json_str)

  demisto.results({
      "EntryContext": {JSON_CONTEXT_KEY: obj},
      "Type": entryTypes['note'],
      "ContentsFormat": formats['json'],
      "ReadableContentsFormat": formats['json'],
      "HumanReadable": obj,
      "Contents": obj})
type: python
tags: []
enabled: true
args:
- name: Input
  required: true
  default: true
  description: Input string to transform to JSON object
outputs:
- contextPath: JsonObject
  description: The JSON object loaded from input
scripttarget: 0
runonce: false
comment: Load JSON object from input
releaseNotes: "Can read complicated JSONs (list inside a list)"
tests:
- JSONtoCSV-Test